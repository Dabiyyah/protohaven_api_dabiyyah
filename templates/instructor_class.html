<html>
  <head>
    <script
        src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
        crossorigin="anonymous"></script>
    <style>
      .schedule_class {
        padding: 5px;
        margin: 5px;
        border: 1px gray solid;
      }
      .schedule_class.unscheduled {
        font-color: #333;
      }
      .schedule_class.scheduled {
        background-color: #EEEEFF;
      }
      #schedule {
        min-width: 600px;
      }
      #schedule td {
        padding: 5px;
        margin: 5px;
        border: 1px gray solid;
				vertical-align: top;
      }
      #schedule th {
        padding: 25px;
      }
    </style>
  </head>
  <body>
    <h2>Instructor Dashboard</h2>
    <p>Showing events for instructor email {{email}}</p>
    <p>It's currently {{now.strftime('%A %b %-d, %-I%p')}}</p>
		<h2>Scheduled classes:</h2>
    <table id="schedule">
      <thead>
        <tr>
          <th>Class</th>
          <th>Registrants</th>
          <th>Supply State</th>
					<th>Pay Type</th>
          <th>Instructor Log</th>
        </tr>
      </thead>
      <tbody>
      {% for id, event in schedule %}
				{% if event['Confirmed'] %}
					{% include "instructor_class_tr.html" %}
				{% endif %}
      {% endfor %}
      </tbody>
    </table>
		<h2>Proposed classes:</h2>
    <table id="schedule">
      <thead>
        <tr>
          <th>Class</th>
          <th>Registrants</th>
          <th>Supply State</th>
          <th>Pay Type</th>
        </tr>
      </thead>
      <tbody>
      {% for id, event in schedule %}
				{% if not event['Confirmed'] %}
					{% include "instructor_class_tr.html" %}
				{% endif %}
      {% endfor %}
      </tbody>
    </table>
  </body>
  <script type="text/javascript">
    $("#schedule button").click(function(e) {
          let eid = $(e.target).parentsUntil(".schedule_class").parent().attr("id");
          let cls = e.target.className;

          if (cls === 'publish' || cls == 'unpublish') {
            console.log(eid, pub);

            $.post("/instructor/class/update", {eid, pub: cls === 'publish'}).then(function(data) {
                  location.reload();
            });
          } else if (cls === 'log_submit') {
            window.location = e.target.getAttribute('href');
          } else if (cls === 'supply_req' || cls === 'supply_conf') {
            $.post("/instructor/class/supply_req", {eid, missing: cls === 'supply_req'}).then(function(data) {
                  location.reload();
            });
          } else if (cls === 'pay_on' || cls === 'pay_off') {
            $.post("/instructor/class/volunteer", {eid, volunteer: cls === 'pay_off'}).then(function(data) {
                  location.reload();
            });
          }
        });
  </script>
</html>
